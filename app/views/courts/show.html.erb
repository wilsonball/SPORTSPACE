<div class="panel panel-default">

	<div class="panel-body">
		<div class="col-md-12">
		<!--Main Info-->
				<!--court info-->
				<div class="row">

					<!--listing name/address-->
					<div class="row">					
						<div class="col-md-8">
							<h2><strong><%= @court.listing_name %></strong></h2>
								<% if current_user && current_user == @court.user %>
									<p><%= link_to "Edit My Listing", edit_court_path%></p>
								<% else %>
									<!--<p><%= link_to "Suggest An Edit", edit_court_path %></p>-->
								<% end %>
							<span id="average_rating"></span> (<%= @court.average_rating %> Stars) <%= @reviews.count %> Review(s)
							<!--Write a review popup window or redirect to write a review area on this page-->
							<h4><%= @court.address %></h4>					
							<!--Gmap-->
							<div class="row">
								<div class="col-md-12">
									<style>
								      #map {
								        width: 100%;
								        height: 400px;
								      }
					    		</style>								   

								    <div id="map"></div>

								</div>
							</div>
												<!--icons-->
					<div class="col-md-12">
						<div class="row text-center row-space-3">
								<div class="col-sm-3">
									<i class="fa fa-home fa-2x"></i>
									<p><%= @court.court_type %> Court</p>
									<p>
								</div>
								<div class="col-sm-3">
									<i class="fa fa-users fa-2x"></i>
									<p>People Played Here</p>
								</div>
								<div class="col-sm-3">
									<i class="fa fa-bed fa-2x"></i>
									<p><%= @court.court_count %> Court(s)</p>
								</div>
								<div class="col-sm-3">
									<i class="fa fa-ship fa-2x"></i>
									<p>Other</p>
								</div>
							</div>
					</div>

					<!--summary-->
					<div class="row">
						<div class="col-md-12">
							<h3>Court Description</h3>
							<p><%= @court.summary %></p>
						</div>
					</div>

					<!--court features-->
					<h3>Court Features</h3>				
					<div class"row">
							<div class="col-md-12">
								<div class="col-md-6 pull-left">
									<ul class="amenities">
										<li class="<%= 'text-line-through' if !@court.is_3pt %>">3PT</li>
										<li class="<%= 'text-line-through' if !@court.is_ncaa3pt %>">NCAA 3PT</li>
										<li class="<%= 'text-line-through' if !@court.is_nba3pt %>">NBA 3PT</li>
								</div>
								<div class="col-md-6">
									<ul class="amenities">
										<li class="<%= 'text-line-through' if !@court.is_centercircle %>">Center Circle</li>
										<li class="<%= 'text-line-through' if !@court.is_key %>">Key</li>
										<li class="<%= 'text-line-through' if !@court.is_freethrowline %>">Free Throw Line</li>
									</ul>
								</div>
							</div>					
					</div>

						</div>
						<div class="col-md-4">
							<!--runs form-->
							<p id="runsform">
								<%= render 'runs/form' %>
							</p>
							<p id="seengamesform">
								<%= render 'seengames/form' %>
							</p>
							<p id="seenplayersform">
								<%= render 'seenplayers/form' %>
							</p>
						</div>
						<!--<div class="col-md-3 text-center">
							<h4>Court Manager</h4>
							<%= image_tag avatar_url(@court.user), class: "img avatar-large" %><br><br>
							<%= @court.user.fullname %>
						</div>-->
					</div>
					<br>

					<!--Carousel-->
				<div class="row">
					<div class="col-md-12">
						<div id="myCarousel" class="carousel slide" data-ride="carousel">
						  <!-- Indicators -->
						  <% if @photos %>				  
							  <ol class="carousel-indicators">
							  	<% @photos.each do |photo| %>
							    	<li data-target="#myCarousel" data-slide-to="<%= photo.id %>"></li>
							    <% end %>
							  </ol>
						  <% end %>

						  <!-- Wrapper for slides -->
						  <div class="carousel-inner" role="listbox">
						  	<% if @photos %>
						  	  <% @photos.each do |photo| %>
						    	<div class="item <%= 'active' if photo.id == @photos[0].id %>">
						      		<%= image_tag photo.image.url() %>
						    	</div>
						      <% end %>
						    <% end %>
						    </div>			    

						  <!-- Left and right controls -->
						  <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
						    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
						    <span class="sr-only">Previous</span>
						  </a>
						  <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
						    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
						    <span class="sr-only">Next</span>
						  </a>
						</div>
					</div>
				</div>

				<!--add a photo-->

				<hr>

					<!--Reviews-->
					<div class="row">
						<div class="col-md-8">
							<h3 id="reviewsform">Reviews</h3>
								<div>
									<%= render 'reviews/form' if !@hasReview %>
								</div>
								<div>
									<%= render 'reviews/list' %>
								</div>
							
						</div>
					</div>

					<!--Closeby-->
					<h3>Nearby Courts</h3>
					<div class="row">
						<% for court in @court.nearbys(5).limit(3) %>
							<div class ="col-md-4">
								<div class="panel panel-default">
									<%= link_to court do %>
									<div class="panel-heading preview">
										<%= image_tag court.show_first_photo_medium %>
									</div>
									<div class="panel-body">
										<%= link_to court.listing_name, court %><br>
										(<%= court.distance.round(2) %> Miles Away)
									</div>
									<% end %>
								</div>
							</div>
						<% end %>
					</div>

				</div>

				<!--checkins feed-->

				<!--heatmap-->
			</div>
		</div>
	</div>
</div>
</div>

<script>
	$('#average_rating').raty({
		path: '/assets',
		readOnly: true,
		score: <%= @court.average_rating %>
	});
</script>

<!--<script>
$(function(){ // document ready
 
  if (!!$('.sticky').offset()) { // make sure ".sticky" element exists
 
    var stickyTop = $('.sticky').offset().top; // returns number 
 
    $(window).scroll(function(){ // scroll event
 
      var windowTop = $(window).scrollTop(); // returns number 
 
      if (stickyTop < windowTop){
        $('.sticky').css({ position: 'fixed', top: 0 });
      }
      else {
        $('.sticky').css('position','static');
      }
 
    });
 
  }
 
});
</script>-->

<script src="https://maps.googleapis.com/maps/api/js"></script>

<script>
  function initialize() {
    var mapCanvas = document.getElementById('map');
    var mapOptions = {
      scrollwheel: false,
      center: new google.maps.LatLng(<%= @court.latitude %>, <%= @court.longitude %>),
      zoom: 14,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    var map = new google.maps.Map(mapCanvas, mapOptions)

    var marker = new google.maps.Marker({
    	position: new google.maps.LatLng(<%= @court.latitude %>, <%= @court.longitude %>), title: "<%= @court.listing_name %>"
    });

    marker.setMap(map);
  }
  google.maps.event.addDomListener(window, 'load', initialize);
</script>